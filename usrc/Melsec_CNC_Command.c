#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "type.h"
#include "Siemens_CNC.h"
#include "log.h"


u8 buf[100] = {}; 


char* Read_Ver_Info(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x45,                //all length=52+17=69
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x0f,
		0x00,0x34,           //LENGTH=50+2
		0x00,0x00,            // 
		0x04,                 // 
		0x05,                 //  
		0x12,0x08,0x82,0x01,0x46,0x6e,0x00,0x01,0x1a,0x01,
		0x12,0x08,0x82,0x01,0x46,0x78,0x00,0x01,0x1a,0x01,
		0x12,0x08,0x82,0x01,0x46,0x78,0x00,0x02,0x1a,0x01,
		0x12,0x08,0x82,0x01,0x46,0x78,0x00,0x03,0x1a,0x01,
		0x12,0x08,0x82,0x01,0x46,0x78,0x00,0x04,0x1a,0x01 
	};
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* Read_Axis_Name()
{
	char p_send[] = { 0x03,0x00,0x00,0x1d,
		0x02,0xf0,0x80,0x32,0x01,
		0x00,0x00,0x00,0x30,
		0x00,0x0c,
		0x00,0x00,
		0x04,0x01,
		0x12,0x08,0x82,0x41,
		0x4e,0x70,      //16384+3584+112=20080
		0x00,0x01,
		0x1a,0x04 };     //锟斤拷锟侥革拷锟斤拷锟斤拷
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* Read_ToolComp(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x45,                //all length=52+17=69
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x15,
		0x00,0x34,           //LENGTH=50+2
		0x00,0x00,            // 
		0x04,                 // 
		0x05,                 //  
		0x12,0x08,0x82,0x41,0x00,0x71,0x00,0x01,0x7f,0x01,   //3锟斤拷?锟斤拷X  71
		0x12,0x08,0x82,0x41,0x00,0x73,0x00,0x01,0x7f,0x01,
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x02,0x14,0x01,  //锟斤拷???????
		0x12,0x08,0x82,0x41,0x00,0x1b,0x00,0x01,0x7f,0x01 ,  //锟斤拷???
		0x12,0x08,0x82,0x41,0x01,0xb6,0x00,0x01,0x7f,0x01 }; //H
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char *Read_Oprate_Mode(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x27,                     //all length=22+17=39
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x0b,
		0x00,0x16,                 //LENGTH=20+2
		0x00,0x00,
		0x04,
		0x02,
		0x12,0x08,0x82,0x21,0x00,0x03,0x00,0x01,0x7f,0x01,  //JOG AUTO 
		0x12,0x08,0x82,0x41,0x00,0x0c,0x00,0x01,0x7f,0x01   //REF
	};   //21   03
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* ReadCycStart(void)
{
	Si_CNC_data.m_nCycleNum = 1;
	char p_send[] = {
		0x03,0x00,0x00,
		0x27,                     //all length=22+17=39
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x0c,
		0x00,0x16,                 //LENGTH=20+2
		0x00,0x00,
		0x04,
		0x02,
		0x12,0x08,0x82,0x41,0x00,0x0b,0x00,0x01,0x7f,0x01,    //CYCSTART
		0x12,0x08,0x82,0x41,0x00,0x0d,0x00,0x01,0x7f,0x01
	};  //CYCSTART
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* ReadCyc2Start()
{
	Si_CNC_data.m_nCycleNum = 2;
	char p_send[] = {
		0x03,0x00,0x00,
		0x27,                     //all length=22+17=39
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x0c,
		0x00,0x16,                 //LENGTH=20+2
		0x00,0x00,
		0x04,
		0x02,
		0x12,0x08,0x82,0x42,0x00,0x0b,0x00,0x01,0x7f,0x01,    //CYCSTART
		0x12,0x08,0x82,0x42,0x00,0x0d,0x00,0x01,0x7f,0x01 };  //CYCSTART
															  ////#endif // !USE_CHANNEL2
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* Read_AUTOFeed_Data(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x31,                //all length=32+17=49
		02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x09,
		0x00,0x20,           //LENGTH=30+2
		0x00,0x00,
		0x04,
		0x03,
		0x12,0x08,0x82,0x41,0x00,0x01,0x00,0x01,0x7f,0x01,   //FACT
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x01,0x7f,0x01,   //FSET
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x01,0x7f,0x01,   //FRATE
	}; //F_RATE
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char *Read_S_Data()
{
	char p_send[] = {
	0x03,0x00,0x00,
	0x31,                //all length=32+17=49
	02,0xf0,0x80,0x32,
	0x01,
	0x00,0x00,0x00,0x0a,
	0x00,0x20,           //LENGTH=30+2
	0x00,0x00,
	0x04,
	0x03,
	0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x01,0x72,0x01,    //37 S_ACT
	0x12,0x08,0x82,0x01,0x00,0x03,0x00,0x04,0x72,0x01,       //S_SET
	0x12,0x08,0x82,0x41,0x00,0x04,0x00,0x01,0x72,0x01 };    //S_RATE
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* Read_once_axisvalue(void)
{
	char p_send[] = { 0x03,0x00,
		0x00,0x63,                   //82+17=99=63
		0x02,0xf0,0x80,0x32,0x01,
		0x00,0x00,0x00,0x0e,             //refernce uint
		0x00,0x52 ,                           //  paramenter 
		0x00,0x00,                            //data lengthe=
		0x04,                                 //read var
		0x08,                                  ////itcount=8;
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x01,0x74,0x01, //
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x02,0x74,0x01,
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x03,0x74,0x01,
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x04,0x74,0x01,
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x01,0x74,0x01,  //
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x02,0x74,0x01,
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x03,0x74,0x01,
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x04,0x74,0x01
	};
	memcpy(buf,p_send,sizeof(p_send));
	return buf;
}

char* Read_Work_Axis(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x3b,                //all length=42+17
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x14,
		0x00,0x2a,           //LENGTH=40+2
		0x00,0x00,
		0x04,
		0x04,
		0x12,0x08,0x82,0x41,0x00,0x19,0x00,0x01,0x70,0x01,  //X
		0x12,0x08,0x82,0x41,0x00,0x19,0x00,0x02,0x70,0x01,  //Y
		0x12,0x08,0x82,0x41,0x00,0x19,0x00,0x03,0x70,0x01,  //Z
		0x12,0x08,0x82,0x41,0x00,0x19,0x00,0x04,0x70,0x01   //4
	}; 
	memcpy(buf,p_send,sizeof(p_send));
	return buf;		
}

char* ReadTDnumber(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x27,                     //all length=22+17=39
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x08,
		0x00,0x16,                 //LENGTH=20+2
		0x00,0x00,
		0x04,
		0x02,
		0x12,0x08,0x82,0x41,0x00,0x17,0x00,0x01,0x7f,0x01,  //T
		0x12,0x08,0x82,0x41,0x00,0x18,0x00,0x01,0x7f,0x01   //D
		}; 
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* Read_JOG_FEEDRATE(void)
{
	char p_send[] = {
		0x03,0x00,
		0x00,
		0x31,                //all length=32+17=49
		0x02,0xf0,0x80,0x32,0x01,
		0x00,0x00,0x00,0x07,
		0x00,0x20,           //LENGTH=30+2
		0x00,0x00,            //item count=3
		0x04,                 //reserved
		0x03,                 // NCK_ADDRESS1  
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x01,0x70,0x01,   //FACT     JOG  70
		0x12,0x08,0x82,0x41,0x00,0x02,0x00,0x01,0x70,0x01,   //FACT
		0x12,0x08,0x82,0x41,0x00,0x03,0x00,0x01,0x7f,0x01,   //FRATE
	}; //F_RATE
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* Read_Piece_Time(void)
{
	char p_send[] = {
		0x03,0x00,0x00,
		0x3b,                //all length=42+17
		0x02,0xf0,0x80,0x32,
		0x01,
		0x00,0x00,0x00,0x11,
		0x00,0x2a,           //LENGTH=40+2
		0x00,0x00,
		0x04,
		0x04,
		0x12,0x08,0x82,0x41,0x01,0x29,0x00,0x01,0x7f,0x01,  //3锟斤拷D锟斤拷锟斤拷??-??DD锟斤拷锟斤拷??
		0x12,0x08,0x82,0x41,0x01,0x2a,0x00,0x01,0x7f,0x01,  //3锟斤拷D锟斤拷锟斤拷锟疥ó锟斤拷锟斤拷锟斤拷??
		0x12,0x08,0x82,0x41,0x00,0x79,0x00,0x01,0x7f,0x01,  //锟斤拷锟斤拷?锟斤拷1锟斤拷?t锟斤拷y
		0x12,0x08,0x82,0x41,0x00,0x77,0x00,0x01,0x7f,0x01   //1锟斤拷?tD锟斤拷?锟斤拷锟斤拷y
	}; 
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* ReadProcessName(void)
{
	char p_send[] = { 0x03,0x00,0x00,0x1d,    //12+17=29
		0x02,0xf0,0x80,0x32,0x01,
		0x00,0x00,0x00,0x12,
		0x00,0x0c,  //10+2
		0x00,0x00,
		0x04,
		0x01,
		0x12,0x08,0x82,0x41,0x00,0x0c,0x00,0x01,0x7a,0x01 
	};
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* ReadAlarmNo(void)
{
	char p_send[] = { 0x03,0x00,0x00,0x2b,
		0x02,0xf0,0x80,0x32,0x07,0x00,0x00,0x00,0x10,0x00,0x08,0x00,0x12,0x00,0x01,
		0x12,0x04,
		0x11,0x02,0x01,0x00,
		0xff,0x09,0x00,0x0e,0x00,0x01,0x0d,0x11,
		0x12,0x08,0x82,0x01,0x00,0x00,0x00,0x01,0x54,0x01 };
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* ReadONCEAlarmNo(void)
{
	char p_send[] = { 0x03,0x00,0x00,0x1d,    //12+17=29
		0x02,0xf0,0x80,0x32,0x01,
		0x00,0x00,0x00,0x12,
		0x00,0x0c,  //10+2
		0x00,0x00,
		0x04,
		0x01,
		0x12,0x08,0x82,0x01,0x00,0x00,0x00,0x01,0x54,0x01 };
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}

char* finish_collect(void)
{
	char p_send[] = { 0x03, 0x00, 0x00, 0x07, 0x02, 0xf0, 0x00 };
	memcpy(buf,p_send,sizeof(p_send));
	return buf;			
}


char* (*Si_CNC_Collect_Type[_Collect_Num])(void) ={
	&ReadCycStart,
	&Read_Oprate_Mode,
	&Read_Ver_Info,
	&Read_Axis_Name,
	&Read_ToolComp,
//	&ReadCyc2Start,
	&Read_AUTOFeed_Data,
	&Read_S_Data,
	&Read_once_axisvalue,
	&Read_Work_Axis,
	&ReadTDnumber,
	//&Read_JOG_FEEDRATE,
	&Read_Piece_Time,
	&ReadProcessName,
	&ReadAlarmNo,
	//&finish_collect,
};

char* Get_Si_CNC_CMD_STR(int i)
{
	if(i < _Collect_Num)
	{
		return Si_CNC_Collect_Type[i]();
	}
	return "ERROR";
}

int Get_SendDataCNT(void)
{
	return _Data_Num;
}